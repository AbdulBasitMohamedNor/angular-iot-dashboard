import{Fa as k,Ia as T,J as L,K as C,M as D,N as E,P as S,S as z,U as h,a as b,ba as g,c,f as y,fa as u,h as l,ha as O,i as w,ka as M,kb as R,nb as m,pb as p,qb as a}from"./chunk-H2ARN4F4.js";import{e as d}from"./chunk-JKOY2XUY.js";var I=class n{_theme=u("auto");_isDark=u(!1);theme=this._theme.asReadonly();isDark=this._isDark.asReadonly();constructor(){let t=localStorage.getItem("theme");t?this.setTheme(t):this.setTheme("auto"),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",s=>{this._theme()==="auto"&&(this._isDark.set(s.matches),this.applyTheme())}),m(()=>{this.applyTheme()})}setTheme(t){this._theme.set(t),localStorage.setItem("theme",t),this.updateDarkMode()}toggleTheme(){let t=this._theme();t==="light"?this.setTheme("dark"):t==="dark"?this.setTheme("auto"):this.setTheme("light")}updateDarkMode(){let t=this._theme(),s=window.matchMedia("(prefers-color-scheme: dark)").matches,e=!1;t==="dark"?e=!0:t==="auto"&&(e=s),this._isDark.set(e)}applyTheme(){this._isDark()?(document.documentElement.classList.add("dark-theme"),document.documentElement.setAttribute("data-theme","dark"),document.body.classList.add("dark-mode")):(document.documentElement.classList.remove("dark-theme"),document.documentElement.setAttribute("data-theme","light"),document.body.classList.remove("dark-mode"))}static \u0275fac=function(s){return new(s||n)};static \u0275prov=S({token:n,factory:n.\u0275fac,providedIn:"root"})};function A(n){n||(n=h(g));let t=new c(s=>{if(n.destroyed){s.next();return}return n.onDestroy(s.next.bind(s))});return s=>s.pipe(C(t))}var v=class{source;destroyed=!1;destroyRef=h(g);constructor(t){this.source=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}subscribe(t){if(this.destroyed)throw new E(953,!1);let s=this.source.pipe(A(this.destroyRef)).subscribe({next:e=>t(e)});return{unsubscribe:()=>s.unsubscribe()}}};function i(n,t){return new v(n)}function x(n){let t=R(n);return new c(s=>{let e=t?.onDestroy(()=>s.complete()),r=n.subscribe(o=>s.next(o));return()=>{r.unsubscribe(),e?.()}})}var F=new z("NGX_ECHARTS_CONFIG"),f=class{constructor(){this.subject=new l(1),this.subscriptions=new b}doFilter(t){this.subject.next(t)}dispose(){this.subscriptions.unsubscribe()}notEmpty(t,s){this.subscriptions.add(this.subject.subscribe(e=>{if(e[t]){let r=e[t].currentValue;r!=null&&s(r)}}))}has(t,s){this.subscriptions.add(this.subject.subscribe(e=>{if(e[t]){let r=e[t].currentValue;s(r)}}))}notFirst(t,s){this.subscriptions.add(this.subject.subscribe(e=>{if(e[t]&&!e[t].isFirstChange()){let r=e[t].currentValue;s(r)}}))}notFirstAndEmpty(t,s){this.subscriptions.add(this.subject.subscribe(e=>{if(e[t]&&!e[t].isFirstChange()){let r=e[t].currentValue;r!=null&&s(r)}}))}},le=(()=>{let t=class t{constructor(){this.el=h(M),this.ngZone=h(T),this.config=h(F),this.options=a(null),this.theme=a(this.config.theme??null),this.initOpts=a(null),this.merge=a(null),this.autoResize=a(!0),this.loading=a(!1),this.loadingType=a("default"),this.loadingOpts=a(null),this.chartInit=p(),this.optionsError=p(),this.chartClick=i(this.createLazyEvent("click")),this.chartDblClick=i(this.createLazyEvent("dblclick")),this.chartMouseDown=i(this.createLazyEvent("mousedown")),this.chartMouseMove=i(this.createLazyEvent("mousemove")),this.chartMouseUp=i(this.createLazyEvent("mouseup")),this.chartMouseOver=i(this.createLazyEvent("mouseover")),this.chartMouseOut=i(this.createLazyEvent("mouseout")),this.chartGlobalOut=i(this.createLazyEvent("globalout")),this.chartContextMenu=i(this.createLazyEvent("contextmenu")),this.chartHighlight=i(this.createLazyEvent("highlight")),this.chartDownplay=i(this.createLazyEvent("downplay")),this.chartSelectChanged=i(this.createLazyEvent("selectchanged")),this.chartLegendSelectChanged=i(this.createLazyEvent("legendselectchanged")),this.chartLegendSelected=i(this.createLazyEvent("legendselected")),this.chartLegendUnselected=i(this.createLazyEvent("legendunselected")),this.chartLegendLegendSelectAll=i(this.createLazyEvent("legendselectall")),this.chartLegendLegendInverseSelect=i(this.createLazyEvent("legendinverseselect")),this.chartLegendScroll=i(this.createLazyEvent("legendscroll")),this.chartDataZoom=i(this.createLazyEvent("datazoom")),this.chartDataRangeSelected=i(this.createLazyEvent("datarangeselected")),this.chartGraphRoam=i(this.createLazyEvent("graphroam")),this.chartGeoRoam=i(this.createLazyEvent("georoam")),this.chartTreeRoam=i(this.createLazyEvent("treeroam")),this.chartTimelineChanged=i(this.createLazyEvent("timelinechanged")),this.chartTimelinePlayChanged=i(this.createLazyEvent("timelineplaychanged")),this.chartRestore=i(this.createLazyEvent("restore")),this.chartDataViewChanged=i(this.createLazyEvent("dataviewchanged")),this.chartMagicTypeChanged=i(this.createLazyEvent("magictypechanged")),this.chartGeoSelectChanged=i(this.createLazyEvent("geoselectchanged")),this.chartGeoSelected=i(this.createLazyEvent("geoselected")),this.chartGeoUnselected=i(this.createLazyEvent("geounselected")),this.chartAxisAreaSelected=i(this.createLazyEvent("axisareaselected")),this.chartBrush=i(this.createLazyEvent("brush")),this.chartBrushEnd=i(this.createLazyEvent("brushend")),this.chartBrushSelected=i(this.createLazyEvent("brushselected")),this.chartGlobalCursorTaken=i(this.createLazyEvent("globalcursortaken")),this.chartRendered=i(this.createLazyEvent("rendered")),this.chartFinished=i(this.createLazyEvent("finished")),this.animationFrameID=null,this.chart$=new l(1),this.resize$=new y,this.changeFilter=new f,this.resizeObFired=!1,this.echarts=this.config.echarts}ngOnChanges(e){this.changeFilter.doFilter(e)}ngOnInit(){if(!window.ResizeObserver)throw new Error("please install a polyfill for ResizeObserver");this.resizeSub=this.resize$.pipe(D(100,w,{leading:!1,trailing:!0})).subscribe(()=>this.resize()),this.autoResize()&&(this.resizeOb=this.ngZone.runOutsideAngular(()=>new window.ResizeObserver(e=>{for(let r of e)r.target===this.el.nativeElement&&(this.resizeObFired?this.animationFrameID=window.requestAnimationFrame(()=>{this.resize$.next()}):this.resizeObFired=!0)})),this.resizeOb.observe(this.el.nativeElement)),this.changeFilter.notFirstAndEmpty("options",e=>this.onOptionsChange(e)),this.changeFilter.notFirstAndEmpty("merge",e=>this.setOption(e)),this.changeFilter.has("loading",e=>this.toggleLoading(!!e)),this.changeFilter.notFirst("theme",()=>this.refreshChart())}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&this.resizeSub.unsubscribe(),this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeOb&&this.resizeOb.unobserve(this.el.nativeElement),this.loadingSub&&this.loadingSub.unsubscribe(),this.changeFilter.dispose(),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.chart.resize()}toggleLoading(e){this.chart?e?this.chart.showLoading(this.loadingType(),this.loadingOpts()):this.chart.hideLoading():this.loadingSub=this.chart$.subscribe(r=>e?r.showLoading(this.loadingType(),this.loadingOpts()):r.hideLoading())}setOption(e,r){if(this.chart)try{this.chart.setOption(e,r)}catch(o){console.error(o),this.optionsError.emit(o)}}refreshChart(){return d(this,null,function*(){this.dispose(),yield this.initChart()})}createChart(){let e=this.el.nativeElement;if(window&&window.getComputedStyle){let r=window.getComputedStyle(e,null).getPropertyValue("height");(!r||r==="0px")&&(!e.style.height||e.style.height==="0px")&&(e.style.height="400px")}return this.ngZone.runOutsideAngular(()=>(typeof this.echarts=="function"?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:o})=>o(e,this.theme()??this.config?.theme,this.initOpts())))}initChart(){return d(this,null,function*(){yield this.onOptionsChange(this.options());let e=this.merge();e&&this.chart&&this.setOption(e)})}onOptionsChange(e){return d(this,null,function*(){e&&(this.chart?this.setOption(this.options(),!0):(this.chart=yield this.createChart(),this.chart$.next(this.chart),this.chartInit.emit(this.chart),this.setOption(this.options(),!0)))})}createLazyEvent(e){return x(this.chartInit).pipe(L(r=>new c(o=>(r.on(e,j=>this.ngZone.run(()=>o.next(j))),()=>{this.chart&&(this.chart.isDisposed()||r.off(e))}))))}};t.\u0275fac=function(r){return new(r||t)},t.\u0275dir=k({type:t,selectors:[["echarts"],["","echarts",""]],inputs:{options:[1,"options"],theme:[1,"theme"],initOpts:[1,"initOpts"],merge:[1,"merge"],autoResize:[1,"autoResize"],loading:[1,"loading"],loadingType:[1,"loadingType"],loadingOpts:[1,"loadingOpts"]},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartHighlight:"chartHighlight",chartDownplay:"chartDownplay",chartSelectChanged:"chartSelectChanged",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendLegendSelectAll:"chartLegendLegendSelectAll",chartLegendLegendInverseSelect:"chartLegendLegendInverseSelect",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartGraphRoam:"chartGraphRoam",chartGeoRoam:"chartGeoRoam",chartTreeRoam:"chartTreeRoam",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartGeoSelectChanged:"chartGeoSelectChanged",chartGeoSelected:"chartGeoSelected",chartGeoUnselected:"chartGeoUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartGlobalCursorTaken:"chartGlobalCursorTaken",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[O]});let n=t;return n})();function ue(n){return{provide:F,useValue:n}}export{le as a,ue as b,I as c};
